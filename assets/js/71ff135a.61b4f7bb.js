"use strict";(self.webpackChunkanalytics_sdk_extensions=self.webpackChunkanalytics_sdk_extensions||[]).push([[1401],{674:(e,i,a)=>{a.r(i),a.d(i,{assets:()=>d,contentTitle:()=>c,default:()=>u,frontMatter:()=>t,metadata:()=>n,toc:()=>r});const n=JSON.parse('{"id":"sdks/analytics-sdks/ios/advanced-usage/ios-analytics-app-to-web","title":"App to WebView Tracking","description":"App to web tracking","source":"@site/docs/sdks/analytics-sdks/ios/advanced-usage/app-to-web.md","sourceDirName":"sdks/analytics-sdks/ios/advanced-usage","slug":"/analytics-sdk/ios/ios-app-to-web","permalink":"/rakuten-analytics-public-docs/docs/analytics-sdk/ios/ios-app-to-web","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8,"id":"ios-analytics-app-to-web","slug":"/analytics-sdk/ios/ios-app-to-web","title":"App to WebView Tracking","added_version":"5.3.0","updated_version":"9.4.0","changelog":"./ios-changelog"},"sidebar":"docSidebar","previous":{"title":"Debug Logging","permalink":"/rakuten-analytics-public-docs/docs/analytics-sdk/ios/ios-debug-logging"},"next":{"title":"Batching Delay","permalink":"/rakuten-analytics-public-docs/docs/analytics-sdk/ios/ios-batching-delay"}}');var s=a(4848),o=a(8453);const t={sidebar_position:8,id:"ios-analytics-app-to-web",slug:"/analytics-sdk/ios/ios-app-to-web",title:"App to WebView Tracking",added_version:"5.3.0",updated_version:"9.4.0",changelog:"./ios-changelog"},c=void 0,d={},r=[{value:"App to web tracking",id:"app-to-web-tracking",level:2},{value:"<code>ra_uid</code> Cookie Format",id:"ra_uid-cookie-format",level:3},{value:"Example of the <code>ra_uid</code> cookie value",id:"example-of-the-ra_uid-cookie-value",level:3}];function l(e){const i={code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.h2,{id:"app-to-web-tracking",children:"App to web tracking"}),"\n",(0,s.jsxs)(i.p,{children:["You can configure the SDK to inject a special tracking cookie called ",(0,s.jsx)(i.code,{children:"ra_uid"}),", which allows RAT to track events between the app and in-app webviews. This functionality allows you to track either a single domain or multiple domains. The cookie is only injected on iOS 11.0 and later versions. This feaure is OFF by default. It can be enabled by setting ",(0,s.jsx)(i.code,{children:"enableAppToWebTracking"})," to true."]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-swift",children:"AnalyticsManager.shared().enableAppToWebTracking = true\n"})}),"\n",(0,s.jsxs)(i.p,{children:["By default the cookie's domain will be set to the top-level Rakuten domain. Optionally, you can set a custom domain(s) on the tracking cookie with ",(0,s.jsx)(i.code,{children:"setWebTrackingCookieMultipleDomains(:)"})," method:"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-swift",children:'// To set a custom tracking cookie to a domain\nAnalyticsManager.shared().setWebTrackingCookieMultipleDomains(array: [".my-domain.co.jp"])\n\n// To set custom tracking cookies to more than 1 domain\nAnalyticsManager.shared().setWebTrackingCookieMultipleDomains(array: [".my-domain.co.jp", ".example-domain.com"])\n'})}),"\n",(0,s.jsxs)(i.p,{children:["Both ",(0,s.jsx)(i.code,{children:"setWebTrackingCookieMultipleDomains"})," and ",(0,s.jsx)(i.code,{children:"setWebTrackingCookieMultipleDomains"})," have an optional completion handler. This handler returns the array of edited tracking ",(0,s.jsx)(i.code,{children:"HTTPCookie"}),"."]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-swift",children:'AnalyticsManager.shared().setWebTrackingCookieMultipleDomains(array: [".my-domain.co.jp", ".example-domain.com"]) { [weak self] trackingCookies in\n    // Edited cookie is available here as [HTTPCookie], the number of elements depends on the passed domain(s)\n}\n'})}),"\n",(0,s.jsxs)(i.p,{children:["\u26a0\ufe0f The previous set domain API ",(0,s.jsx)(i.code,{children:"setWebTrackingCookieDomain"})," is deprecated so if you are using that method, we suggest to update to use ",(0,s.jsx)(i.code,{children:"setWebTrackingCookieMultipleDomains(:)"})," instead."]}),"\n",(0,s.jsxs)(i.p,{children:["Two key parameters used in the ",(0,s.jsx)(i.code,{children:"ra_uid"})," cookie are ",(0,s.jsx)(i.code,{children:"ckp"})," and ",(0,s.jsx)(i.code,{children:"cka"}),":"]}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"ckp"}),": This is the unique device identifier, used to track the device across all Rakuten applications."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.strong,{children:"cka"}),": This is the Advertising ID (IDFA), a unique, user-resettable identifier. It is used for advertising and analytics purposes. If the IDFA is not available, a default value of ",(0,s.jsx)(i.code,{children:"00000000-0000-0000-0000-000000000000"})," is used."]}),"\n"]}),"\n",(0,s.jsxs)(i.h3,{id:"ra_uid-cookie-format",children:[(0,s.jsx)(i.code,{children:"ra_uid"})," Cookie Format"]}),"\n",(0,s.jsxs)(i.p,{children:["The cookie is formatted using the ",(0,s.jsx)(i.code,{children:"COOKIE_FORMAT"}),", which is defined as:"]}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-swift",children:'COOKIE_FORMAT = "rat_uid=%s;a_uid=%s"\n'})}),"\n",(0,s.jsx)(i.p,{children:"In this format:"}),"\n",(0,s.jsxs)(i.ul,{children:["\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"rat_uid"})," takes the value of ",(0,s.jsx)(i.code,{children:"ckp"}),"."]}),"\n",(0,s.jsxs)(i.li,{children:[(0,s.jsx)(i.code,{children:"a_uid"})," takes the value of ",(0,s.jsx)(i.code,{children:"cka"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(i.h3,{id:"example-of-the-ra_uid-cookie-value",children:["Example of the ",(0,s.jsx)(i.code,{children:"ra_uid"})," cookie value"]}),"\n",(0,s.jsx)(i.p,{children:"For each domain you configure, the cookie will appear as follows in the request content:"}),"\n",(0,s.jsx)(i.pre,{children:(0,s.jsx)(i.code,{className:"language-swift",children:"// IDFA is available\nra_uid=rat_uid%3D82b93c49c8cc62a76e26346433dee49c%3Ba_uid%3Dad7ab8a4-83c8-4ae2-b31f-20b453a62621\n\n// IDFA is not available\nra_uid=rat_uid%3D82b93c49c8cc62a76e26346433dee49c%3Ba_uid%3D00000000-0000-0000-0000-000000000000\n"})})]})}function u(e={}){const{wrapper:i}={...(0,o.R)(),...e.components};return i?(0,s.jsx)(i,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,i,a)=>{a.d(i,{R:()=>t,x:()=>c});var n=a(6540);const s={},o=n.createContext(s);function t(e){const i=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function c(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),n.createElement(o.Provider,{value:i},e.children)}}}]);